# 工时模块需求文档（V1）

## 1. 背景与目标

在当前项目管理与成本统计场景下，需要一个**统一、可控的工时记录模块**，用于记录项目在不同时间维度下的工时数据，并为后续统计、成本核算提供基础数据。

**V1 版本目标：**

* 建立标准化的工时记录能力
* 由**项目负责人 / 组织负责人**统一维护工时数据，确保数据权威性
* 为后续统计分析、成本计算模块提供稳定输入

**V1 明确不做：**

* 员工自行添加工时
* 员工自行修改工时
* 复杂审批流

---

## 2. 角色定义与权限

### 2.1 角色说明

| 角色    | 说明                    |
| ----- | --------------------- |
| 普通员工  | 项目成员，仅可查看与自己相关的工时     |
| 项目负责人 | 单个项目的负责人，具备该项目工时维护权限  |
| 组织负责人 | 组织/公司级负责人，具备全项目工时维护权限 |

### 2.2 权限矩阵（V1）

| 功能   | 普通员工   | 项目负责人     | 组织负责人     |
| ---- | ------ | --------- | --------- |
| 查看工时 | ✅（仅本人） | ✅（项目内）    | ✅（全部）     |
| 新增工时 | ❌      | ✅         | ✅         |
| 修改工时 | ❌      | ✅         | ✅         |
| 删除工时 | ❌      | ❌（V1 不开放） | ❌（V1 不开放） |

> 说明：V1 阶段**不支持删除工时**，避免数据被随意清空，后续可通过修正工时方式处理。

---

## 3. 业务范围与核心概念

### 3.1 工时记录定义

一条工时记录用于描述：

* **某个员工**
* 在**某一天**
* 为**某个项目**
* 工作了**多少时长**

### 3.2 工时单位

* 基础单位：小时（支持 0.5 / 0.25 等小数）
* 前端展示可换算为“小时 + 分钟”

---

## 4. 功能需求

### 4.1 新增工时

**操作人：** 项目负责人 / 组织负责人

**触发入口：**

* 项目详情页 → 工时管理 → 新增工时
* 日历视图某一天 → 新增工时

**必填字段：**

| 字段  | 说明         |
| --- | ---------- |
| 项目  | 当前项目（默认带出） |
| 员工  | 从项目成员中选择（包含项目负责人、组织负责人）   |
| 日期  | 工时所属日期     |
| 工时数 | 工作时长（小时）   |

**校验规则：**

* 单人单项目单日工时 ≤ 24 小时
* 工时数 > 0
* 日期不可晚于当前日期

---

### 4.2 修改工时

**操作人：** 项目负责人 / 组织负责人

**修改范围：**

* 工时数
* 工时日期（可选）

**修改规则：**

* 仅允许修改当前项目下的工时记录
* 修改后需保留修改时间与修改人（用于审计）

---

### 4.3 查看工时

#### 4.3.1 项目维度查看

* 项目详情页展示工时汇总：

  * 项目总工时
  * 按成员汇总工时

#### 4.3.2 个人维度查看（员工）

* 仅可查看：

  * 自己在各项目下的工时记录
* 支持按：

  * 日期
  * 项目
  * 月份筛选

---

### 4.4 工时汇总与统计（基础版）

**统计维度：**

* 按项目统计总工时
* 按员工统计总工时
* 按月份统计工时

> 说明：V1 仅提供基础汇总数据，为后续统计模块提供数据支撑，不强调复杂图表。

---

## 5. 数据模型（简化）

### 5.1 工时表（work_time）

| 字段         | 类型       | 说明      |
| ---------- | -------- | ------- |
| id         | string   | 工时记录 ID |
| project_id | string   | 项目 ID   |
| user_id    | string   | 员工 ID   |
| work_date  | date     | 工时日期    |
| work_hours | decimal  | 工时数     |
| created_by | string   | 创建人     |
| updated_by | string   | 最近修改人   |
| created_at | datetime | 创建时间    |
| updated_at | datetime | 修改时间    |

---

## 6. 交互与体验要点（简要）

* 默认以**项目视角**进入工时管理，减少上下文切换
* 新增/修改工时时，员工选择优先展示常用成员
* 日期选择以日历为主，降低输入成本

---

## 7. 非功能性需求

* 操作需记录日志（新增 / 修改）
* 数据变更即时生效，无需审批
* 后端需支持批量新增接口（为后续版本做准备）

---

## 8. V1 不包含内容（明确排除）

* 员工自主填报工时
* 工时审批流
* 工时删除能力
* 与薪资结算强绑定

---

## 9. 后续版本演进方向（非本期）

* 员工提交工时 + 负责人审核
* 批量导入工时（Excel）
* 工时与薪资、成本模块联动
* 工时异常提醒（超时/缺失）

---

**版本信息**

* 版本号：V1.0
* 状态：需求初稿
* 面向对象：产品 / 研发 / 测试
