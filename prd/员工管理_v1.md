# 员工管理模块需求文档（V1）

> 本模块用于管理组织内员工信息、角色权限及薪资类型，为后续工时成本、项目成本统计提供基础数据。

---

## 一、模块目标

员工管理模块用于统一管理组织内员工的：

- 基本信息
- 组织 / 项目角色
- 在职状态
- **工资类型（时薪 / 日薪 / 月薪）**

该模块是工时模块与统计模块的上游依赖。

---

## 二、核心设计原则

1. 员工一定隶属于某个组织
2. 员工可以参与多个项目
3. **工资类型在“员工维度”定义，而不是项目维度**
4. 工资类型用于：
   - 工时成本计算
   - 项目人力成本统计
5. V1 只做“类型 + 数值”，不做复杂薪资规则

---

## 三、数据模型

### 1️⃣ 员工表（Employee）

| 字段 | 类型 | 说明 |
|----|----|----|
| employee_id | ID | 唯一标识 |
| org_id | ID | 所属组织 |
| user_id | ID | 关联的用户 ID |
| name | string | 员工姓名 |
| phone | string | 手机号 |
| email | string | 邮箱 |
| role | enum | 组织内角色（组织负责人 / 成员） |
| status | enum | 状态（在职 / 离职） |
| salary_type | enum | **工资类型（hour / day / month）** |
| salary_amount | decimal | **对应工资数值** |
| hire_date | date | 入职日期 |
| created_at | datetime | 创建时间 |
| updated_at | datetime | 更新时间 |
| is_deleted | boolean | 逻辑删除 |

#### salary_type 说明

| 类型 | 含义 |
|----|----|
| hour | 时薪（元 / 小时） |
| day | 日薪（元 / 天） |
| month | 月薪（元 / 月） |

> ⚠️ 统一约定：  
> - **1 天 = 8 小时（V1 固定）**  
> - 月薪换算规则在统计模块定义

---

### 2️⃣ 项目成员表（ProjectMember）

> ⚠️ 项目成员 **不存工资信息**，仅做角色与关系管理

| 字段 | 类型 | 说明 |
|----|----|----|
| project_member_id | ID | 唯一标识 |
| project_id | ID | 项目 ID |
| user_id | ID | 用户 ID |
| role | enum | 项目角色（负责人 / 成员） |
| is_active | boolean | 是否有效成员 |

---

## 四、功能设计

### 4.1 员工新增 / 编辑

- 组织负责人可新增员工
- 必填项：
  - 姓名
  - 工资类型
  - 工资数值
- 工资类型创建后可修改（历史工时不回溯）

---

### 4.2 工资类型规则

- 每个员工 **只能有一种工资类型**
- 工资类型修改规则：
  - 修改后 **仅影响未来工时**
  - 已产生的历史工时，按当时工资计算

> V1 可通过：
> - 工时表冗余 `cost_snapshot`  
> 或
> - 工资变更时间点  
> 解决历史一致性（实现阶段定）

---

### 4.3 员工离职 / 移除

- 离职员工：
  - 不能再记录工时
  - 仍可参与历史统计
- 工资信息保留，用于历史成本计算

---

## 五、权限控制

| 操作 | 组织负责人 | 项目负责人 | 普通成员 |
|----|----|----|----|
| 新增员工 | ✅ | ❌ | ❌ |
| 编辑员工信息 | ✅ | ❌ | ❌ |
| 设置工资类型 | ✅ | ❌ | ❌ |
| 查看员工工资 | ✅ | ❌ | ❌ |
| 查看自己工资 | ❌ | ❌ | ❌（V1 不开放） |
| 移除员工 | ✅ | ❌ | ❌ |

> ⚠️ **V1 不支持员工查看自己工资信息**，避免薪资敏感问题

---

## 六、与工时模块的关系

- 工时记录表只记录：
  - user_id
  - hours
- 工时成本计算时：
  - 通过 user_id → employee → salary_type
  - 动态或快照计算成本

---

## 七、V1 不做的内容（明确砍掉）

- ❌ 多工资结构
- ❌ 补贴 / 奖金 / 加班规则
- ❌ 不同项目不同工资
- ❌ 月薪考勤规则

---

## 八、总结

员工管理模块在 V1 中的定位是：

> **提供稳定、可追溯的人力基础数据，为工时与成本统计服务**

工资类型是员工的**基础属性**，不是项目属性，也不是工时属性。



# 员工管理模块需求文档

## 一、模块目标

员工管理模块的核心目标是对组织内的员工进行管理，包括员工信息的添加、编辑、查看、删除等功能。同时，系统要支持员工在组织中的角色分配，确保不同角色的员工能够在合适的权限范围内进行操作。

---

## 二、数据模型

### 1️⃣ 员工表（Employee）

| 字段 | 类型 | 说明 |
|----|----|----|
| employee_id | ID | 唯一标识 |
| org_id | ID | 所属组织 |
| user_id | ID | 关联的用户标识，用户表中的ID |
| role | enum | 员工角色（如：组织负责人、项目负责人、普通成员） |
| name | string | 员工姓名 |
| email | string | 员工邮箱 |
| phone | string | 员工手机号 |
| hire_date | date | 入职日期 |
| status | enum | 员工状态（在职、离职、休假等） |
| created_at | datetime | 创建时间 |
| updated_at | datetime | 更新时间 |
| is_deleted | boolean | 是否已删除（逻辑删除） |

- **employee_id**: 唯一标识，用于查询和管理员工数据。
- **org_id**: 员工所属的组织，绑定 `Organization` 表。
- **user_id**: 关联的用户ID，绑定 `User` 表，表示系统登录的用户。
- **role**: 员工在组织中的角色，决定了员工的权限和可操作内容。
- **name**: 员工姓名。
- **email / phone**: 员工的联系方式。
- **hire_date**: 员工加入组织的日期。
- **status**: 员工的状态，可能包括在职、离职、休假等状态。
- **created_at / updated_at**: 员工记录的创建和更新时间。
- **is_deleted**: 逻辑删除标识，防止误删除员工记录。

---

### 2️⃣ 员工-项目关系表（EmployeeProject）

| 字段 | 类型 | 说明 |
|----|----|----|
| employee_project_id | ID | 唯一标识 |
| employee_id | ID | 员工标识 |
| project_id | ID | 项目标识 |
| role | enum | 员工在项目中的角色（如：负责人、成员） |
| status | enum | 员工在项目中的状态（在职、离职） |

- **employee_project_id**: 唯一标识，用于查询和更新员工与项目的关系。
- **employee_id**: 关联的员工ID，绑定 `Employee` 表。
- **project_id**: 关联的项目ID，绑定 `Project` 表。
- **role**: 员工在项目中的角色，决定员工在项目中的权限。
- **status**: 员工在项目中的状态，标识员工是否已从项目中移除或离职。

---

## 三、模块功能

### 1️⃣ 员工信息管理功能

#### 1.1 员工添加与编辑

- 组织负责人可以添加新员工，并分配其角色。
- 可以通过导入员工批量添加员工信息（支持Excel或CSV格式）。
- 支持编辑员工的基本信息，如姓名、邮箱、手机号、角色等。
- 支持更新员工的角色和状态（例如，角色变更、离职）。

#### 1.2 员工查看

- 组织负责人可以查看组织内所有员工的信息。
- 可以按照员工的角色、状态进行筛选查询。
- 支持查看员工参与的项目及其在项目中的角色。

#### 1.3 员工删除

- 组织负责人可以删除员工（逻辑删除，数据保留）。
- 员工删除后，系统会自动将员工从其参与的所有项目中移除。

### 2️⃣ 员工角色与权限管理

#### 2.1 角色管理

- **组织负责人**：创建组织的用户，拥有管理所有项目和员工的权限。
- **项目负责人**：管理项目内的成员，分配角色与权限。
- **普通成员**：参与项目的普通用户，具备参与和记录工时等权限。

#### 2.2 员工角色变更

- **角色变更流程**：组织负责人可以随时调整员工角色，例如将普通成员提升为项目负责人，或将负责人降级为普通成员。
- 角色变更后，员工的权限也会随之调整，确保其在项目中的操作符合角色的要求。

---

## 四、权限控制

| 操作 | 组织负责人 | 项目负责人 | 普通成员 |
|----|----|----|----|
| 添加员工 | ✅ | ❌ | ❌ |
| 编辑员工信息 | ✅ | ✅（项目内） | ❌ |
| 查看员工信息 | ✅ | ✅（项目内） | ✅（自己） |
| 删除员工 | ✅ | ❌ | ❌ |
| 角色变更 | ✅ | ✅（项目内） | ❌ |
| 查看项目成员 | ✅ | ✅（项目内） | ✅（自己参与的项目） |
| 查看员工工时 | ✅ | ✅（项目内） | ✅（自己） |

---

## 五、操作流程

### 1️⃣ 员工添加与编辑

1. 组织负责人在员工管理界面点击“添加员工”。
2. 填写员工基本信息，如姓名、邮箱、电话等，选择角色并分配项目。
3. 点击“保存”后，员工信息被记录到系统中，且员工将在所属组织和项目中生效。
4. 支持批量导入功能，管理员可通过Excel文件批量添加员工。

### 2️⃣ 员工角色变更

1. 组织负责人或项目负责人选择要变更角色的员工。
2. 在员工详情页选择新的角色，并确认变更。
3. 角色变更后，系统会自动调整员工在组织内和项目内的权限。

### 3️⃣ 员工离职或移除

1. 组织负责人可以将离职员工的状态标记为“离职”。
2. 离职员工将自动从项目成员列表中移除，但其工时数据仍保留在历史记录中。
3. 离职员工可以被彻底删除，删除后员工信息无法恢复。

---

## 六、总结

员工管理模块为组织提供了全面的员工信息管理、角色分配和权限控制功能。通过清晰的权限分配与角色管理，确保员工在组织中的各项操作符合规定，有效支持项目管理与工时记录。

---
