# 项目管理模块（组织维度，小程序 V1 · 定型版）

> 本文档针对小程序用户角色设计，采用“组织负责人 / 项目负责人 / 成员”概念

---

## 1. 模块目标

项目管理模块是组织维度下的核心业务模块，负责组织内项目的创建、负责人管理、成员管理及项目维度工时统计，为工时记录与统计模块提供项目归属基础。

---

## 2. 核心概念定义（小程序）

| 概念    | 说明                          |
| ----- | --------------------------- |
| 组织    | 用户创建并加入的业务边界，项目和工时的最高归属单位   |
| 组织负责人 | 创建组织的用户，组织内最高权限，可管理所有项目与成员  |
| 项目    | 组织内用于归集工时的业务实体              |
| 项目负责人 | 项目内最高权限角色，默认由创建组织的用户担任，可被转让 |
| 成员    | 组织内普通用户，可参与项目并记录工时          |
| 历史成员  | 曾参与项目但已被移出，历史工时数据保留         |

----|----|
| 组织负责人 | 创建组织的用户，组织内最高权限，管理项目和成员；默认同时作为组织内首个项目的项目负责人 |
| 项目负责人 | 项目内最高权限，管理项目成员和项目设置 |
| 成员 | 普通员工，可参与项目和记录工时 |
| 组织 | 系统内唯一或可切换的组织，所有项目和成员归属此组织 |
| 项目 | 工时归属的业务容器 |
| 项目成员 | 可为项目记录工时的组织成员（包含项目负责人和组织负责人） |
| 历史成员 | 曾参与项目但已移出，历史工时保留 |

---

## 3. 数据模型（组织维度）

### 3.1 Organization

| 字段         | 类型       | 说明         |
| ---------- | -------- | ---------- |
| org_id     | ID       | 组织唯一标识     |
| name       | string   | 组织名称       |
| created_by | user_id  | 创建人（组织负责人） |
| created_at | datetime | 创建时间       |

### 3.2 UserOrganization

| 字段        | 类型       | 说明         |
| --------- | -------- | ---------- |
| user_id   | ID       | 用户 ID      |
| org_id    | ID       | 组织 ID      |
| role      | enum     | 组织负责人 / 成员 |
| joined_at | datetime | 加入组织时间     |

### 3.3 Project

| 字段          | 类型       | 说明           |
| ----------- | -------- | ------------ |
| project_id  | ID       | 唯一标识         |
| org_id      | ID       | 所属组织         |
| name        | string   | 项目名称         |
| description | string   | 项目描述         |
| owner_id    | user_id  | 项目负责人（项目级唯一） |
| start_date  | date     | 项目开始         |
| end_date    | date     | 项目结束         |
| status      | enum     | 项目状态（V1 仅展示） |
| created_at  | datetime | 创建时间         |
| created_by  | user_id  | 创建人          |
| is_deleted  | boolean  | 逻辑删除         |

### 3.4 ProjectMember

| 字段         | 类型       | 说明             |
| ---------- | -------- | -------------- |
| id         | ID       | 唯一标识           |
| project_id | ID       | 所属项目           |
| user_id    | ID       | 成员 ID          |
| role       | enum     | OWNER / MEMBER |
| joined_at  | datetime | 加入时间           |
| left_at    | datetime | 移出时间           |
| is_active  | boolean  | 是否有效成员         |

---

## 4. 权限规则（小程序，组织维度）

| 操作        | 组织负责人 | 项目负责人  | 成员         |
| --------- | ----- | ------ | ---------- |
| 创建组织      | ✅     | ❌      | ❌          |
| 切换组织      | ✅     | ✅      | ✅          |
| 创建项目      | ✅     | ❌      | ❌          |
| 修改项目负责人   | ✅     | ❌      | ❌          |
| 添加/移除项目成员 | ✅     | ✅（项目内） | ❌          |
| 查看项目      | ✅     | ✅      | ✅（仅参与的项目）  |
| 记录工时      | ✅     | ✅（项目内） | ✅（自己参与的项目） |

----|----|----|----|
| 创建组织 | ✅ | ❌ | ❌ |
| 创建项目 | ✅ | ✅（自己负责的项目） | ❌ |
| 修改项目负责人 | ✅ | ❌ | ❌ |
| 添加/移除项目成员 | ✅ | ✅（项目内） | ❌ |
| 查看项目 | ✅ | ✅ | ✅（仅参与的项目） |
| 记录工时 | ✅ | ✅（项目内成员） | ✅（自己参与的项目） |

---

## 5. 用户体验流程

1. 用户登录 → 创建组织 → 自动成为组织负责人
2. 组织负责人可邀请成员加入组织
3. 用户可切换组织 → 加载对应组织项目和权限
4. 组织负责人可管理组织内所有项目和成员
5. 项目负责人可管理项目内成员和工时
6. 成员可查看自己参与的项目工时

---

## 6. 项目模块功能（组织维度）

### 6.1 项目详情（9.3）

* 项目名称、描述、负责人
* 项目成员列表--点击进入二级页面看列表、新增成员、移除成员
* 展示总人数、总工时、底部展示按员工列表、列表上显示每个人的总工时
* 详情顶部展示日历
* 点击成员人数，点击进入二级页面看列表
* 点击总工时，进入按项目统计页面
* 项目创建时间、状态（展示）
* 历史成员仍可查看项目
* 项目详情页显示统计类的入口点击进入二级页面、按成员汇总工时、按时间范围查看工时，尽量使用二级页面，防止详情过于复杂
* 

### 6.2 项目工时明细（9.4）

* 日期、成员、工时数、备注
* 权限：

  * 成员：仅查看自己的工时
  * 项目负责人 / 组织负责人：可查看所有成员工时

### 6.3 创建/编辑项目（10）

* 创建项目：名称、描述、负责人、成员

  * 创建组织后，系统默认创建一个「初始项目」
  * 创建组织的用户默认作为该项目的项目负责人
* 编辑项目：

  * 组织负责人可修改名称、描述、负责人
  * 支持将项目负责人转让给其他项目成员、成员
* 编辑项目：组织负责人可修改名称、描述、负责人

### 6.4 项目结束规则（11）

* 组织负责人可标记项目结束
* 默认不允许新增工时，可开启“允许补录历史工时”开关
* 当前项目 = 进行中项目
* 历史项目 = 已结束项目
* 两类项目均可参与统计

### 6.5 项目统计（12）

* 指标：项目总工时、成员工时占比、时间跨度
* 支持按项目、时间范围、成员筛选

### 6.6 异常与边界（11）

* 非成员访问项目 → 403
* 历史成员新增工时 → 403
* 移除项目负责人 → 400
* 设置非成员为负责人 → 400
* 项目不存在 → 404

---

## 7. V1 不做但预留能力（14）

* 项目状态流转（暂停/归档）
* 项目标签/类型
* 项目预算工时 vs 实际工时
* 多组织 / 多租户扩展

---

## 7. 项目负责人规则（定型）

### 7.1 默认负责人规则

* 创建组织后，系统自动创建一个「初始项目」（或首个项目）
* 创建组织的用户，默认作为该项目的项目负责人

### 7.2 项目负责人转让

* 项目负责人可被转让给同项目内的其他成员
* 转让操作仅组织负责人可执行
* 转让后：

  * 原负责人自动降级为普通项目成员
  * 新负责人立即获得项目管理权限

---

## 8. 小结

* 小程序角色：组织负责人 > 项目负责人 > 成员
* 一切权限控制基于组织维度 + 角色
* 历史工时和项目数据可追溯
* 组织负责人 = 创建组织的用户，最高权限，管理整个组织内项目与成员
